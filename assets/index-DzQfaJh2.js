import{e as d,m}from"./editor.api-m-XPDcOl.js";import{r as t}from"./index-DoTwNB2L.js";function S(e){return/^\d+$/.test(e)?"".concat(e,"px"):e}function y(){}var U=function(){return U=Object.assign||function(e){for(var u,l=1,n=arguments.length;l<n;l++){u=arguments[l];for(var a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a])}return e},U.apply(this,arguments)};function I(e){var u=e.width,l=e.height,n=e.value,a=e.defaultValue,g=e.language,h=e.theme,M=e.options,R=e.overrideServices,j=e.editorWillMount,P=e.editorDidMount,L=e.editorWillUnmount,b=e.onChange,v=e.className,E=e.original,O=e.originalUri,o=e.modifiedUri,W=t.useRef(null),i=t.useRef(null),V=t.useRef(null),x=t.useRef(null),C=S(u),w=S(l),$=t.useMemo(function(){return{width:C,height:w}},[C,w]),F=function(){var r=j(m);return r||{}},H=function(){P(i.current,m);var r=i.current.getModel().modified;V.current=r.onDidChangeContent(function(f){x.current||b(r.getValue(),f)})},T=function(){L(i.current,m)},c=function(){var r=n??a,f=O==null?void 0:O(m),s=o==null?void 0:o(m),N=f&&d.getModel(f),D=s&&d.getModel(s);N?(N.setValue(E),d.setModelLanguage(N,g)):N=d.createModel(r,g,f),D?(N.setValue(r),d.setModelLanguage(D,g)):D=d.createModel(r,g,s),i.current.setModel({original:N,modified:D})};return t.useEffect(function(){W.current&&(F(),i.current=d.createDiffEditor(W.current,U(U(U({},v?{extraEditorClassName:v}:{}),M),h?{theme:h}:{}),R),c(),H())},[]),t.useEffect(function(){i.current&&i.current.updateOptions(U(U({},v?{extraEditorClassName:v}:{}),M))},[v,M]),t.useEffect(function(){i.current&&i.current.layout()},[u,l]),t.useEffect(function(){if(i.current){var r=i.current.getModel(),f=r.original,s=r.modified;d.setModelLanguage(f,g),d.setModelLanguage(s,g)}},[g]),t.useEffect(function(){if(i.current){var r=i.current.getModel().modified;x.current=!0,i.current.getModifiedEditor().pushUndoStop(),r.pushEditOperations([],[{range:r.getFullModelRange(),text:n}]),i.current.getModifiedEditor().pushUndoStop(),x.current=!1}},[n]),t.useEffect(function(){d.setTheme(h)},[h]),t.useEffect(function(){if(i.current){var r=i.current.getModel().original;E!==r.getValue()&&r.setValue(E)}},[E]),t.useEffect(function(){return function(){if(i.current){T(),i.current.dispose();var r=i.current.getModel(),f=r.original,s=r.modified;f&&f.dispose(),s&&s.dispose()}V.current&&V.current.dispose()}},[]),t.createElement("div",{ref:W,style:$,className:"react-monaco-editor-container"})}I.defaultProps={width:"100%",height:"100%",original:null,value:null,defaultValue:"",language:"javascript",theme:null,options:{},overrideServices:{},editorWillMount:y,editorDidMount:y,editorWillUnmount:y,onChange:y,className:null};I.displayName="MonacoDiffEditor";var p=function(){return p=Object.assign||function(e){for(var u,l=1,n=arguments.length;l<n;l++){u=arguments[l];for(var a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a])}return e},p.apply(this,arguments)},q=function(e,u){var l={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&u.indexOf(n)<0&&(l[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)u.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(l[n[a]]=e[n[a]]);return l};function k(e){var u=e.width,l=e.height,n=e.value,a=e.defaultValue,g=e.language,h=e.theme,M=e.options,R=e.overrideServices,j=e.editorWillMount,P=e.editorDidMount,L=e.editorWillUnmount,b=e.onChange,v=e.className,E=e.uri,O=t.useRef(null),o=t.useRef(null),W=t.useRef(null),i=t.useRef(null),V=S(u),x=S(l),C=t.useRef(b);C.current=b;var w=t.useMemo(function(){return{width:V,height:x}},[V,x]),$=function(){var c=j(m);return c||{}},F=function(){P(o.current,m),W.current=o.current.onDidChangeModelContent(function(c){var r;i.current||(r=C.current)===null||r===void 0||r.call(C,o.current.getValue(),c)})},H=function(){L(o.current,m)},T=function(){var c=n!==null?n:a;if(O.current){var r=p(p({},M),$()),f=E==null?void 0:E(m),s=f&&d.getModel(f);s?(s.setValue(c),d.setModelLanguage(s,g)):s=d.createModel(c,g,f),o.current=d.create(O.current,p(p(p({model:s},v?{extraEditorClassName:v}:{}),r),h?{theme:h}:{}),R),F()}};return t.useEffect(T,[]),t.useEffect(function(){if(o.current){if(n===o.current.getValue())return;var c=o.current.getModel();i.current=!0,o.current.pushUndoStop(),c.pushEditOperations([],[{range:c.getFullModelRange(),text:n}],void 0),o.current.pushUndoStop(),i.current=!1}},[n]),t.useEffect(function(){if(o.current){var c=o.current.getModel();d.setModelLanguage(c,g)}},[g]),t.useEffect(function(){if(o.current){M.model;var c=q(M,["model"]);o.current.updateOptions(p(p({},v?{extraEditorClassName:v}:{}),c))}},[v,M]),t.useEffect(function(){o.current&&o.current.layout()},[u,l]),t.useEffect(function(){d.setTheme(h)},[h]),t.useEffect(function(){return function(){o.current&&(H(),o.current.dispose()),W.current&&W.current.dispose()}},[]),t.createElement("div",{ref:O,style:w,className:"react-monaco-editor-container"})}k.defaultProps={width:"100%",height:"100%",value:null,defaultValue:"",language:"javascript",theme:null,options:{},overrideServices:{},editorWillMount:y,editorDidMount:y,editorWillUnmount:y,onChange:y,className:null};k.displayName="MonacoEditor";export{I as MonacoDiffEditor,k as default,m as monaco};
